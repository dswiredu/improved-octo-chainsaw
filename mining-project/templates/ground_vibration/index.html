{% extends "base.html" %}

{% block content %}

    <!-- PAGE TITLE -->
    <div class="px-6 py-4">
        <div class="flex items-center gap-3">
            <i class="fa-solid fa-explosion text-2xl text-gray-900"></i>
            <h1 class="text-2xl font-bold text-gray-900">
                Ground Vibration Modelling
            </h1>
        </div>
    </div>

<!-- MAIN CONTENT AREA -->
    <div class="flex gap-6 p-6 w-full items-stretch">

        <!-- LEFT INPUT PANEL -->
        <div class="bg-base-100 border border-base-300 shadow-sm rounded-xl p-6 flex-none
                    w-[340px] min-h-[360px]">

            <h2 class="text-lg font-bold mb-6">Model Inputs</h2>

            <!-- FORM -->
            <form method="POST" action="">
                {% csrf_token %}

                <div class="mb-5">
                    <label class="label pb-1">
                        <span class="label-text font-semibold">Distance from Blast (D)</span>
                    </label>
                    <input type="number" name="distance" required step="0.01" min="0"
                        class="input input-bordered w-full"
                        value="{{ distance|default:'' }}">
                </div>

                <div class="mb-5">
                    <label class="label pb-1">
                        <span class="label-text font-semibold">Charge Weight (W)</span>
                    </label>
                    <input type="number" name="weight" required step="0.01" min="0"
                        class="input input-bordered w-full"
                        value="{{ weight|default:'' }}">
                </div>

                <div class="mb-6">
                    <label class="label pb-1">
                        <span class="label-text font-semibold">Select Model</span>
                    </label>
                    <select name="model" class="select select-bordered w-full" required>
                        {% for model in models %}
                            <option value="{{ model }}"
                                    {% if selected_model == model %}selected{% endif %}>
                                {{ model }}
                            </option>
                        {% endfor %}
                    </select>
                </div>

                <button class="btn w-full bg-gray-900 text-white hover:bg-gray-800">
                    Generate Graph
                </button>

            </form>

        </div>

        <!-- RIGHT GRAPH PANEL -->
        <div class="relative bg-base-100 border border-base-300 shadow-sm rounded-xl p-6 flex-1 flex flex-col">

            <!-- TOP RIGHT MENU -->
            <div class="absolute top-4 right-4 z-50">
                <div class="dropdown dropdown-end relative z-50">
                    <label tabindex="0" class="btn btn-ghost btn-xs text-gray-600 z-50">
                        <i class="fa-solid fa-ellipsis-vertical text-xl"></i>
                    </label>

                    <ul tabindex="0"
                        class="dropdown-content menu p-2 shadow bg-base-100 rounded-box w-56 z-[9999]">
                        <li>
                            <a href="{% url 'ground-vibration-export-excel' %}" class="flex items-center gap-2">
                                <i class="fa-solid fa-file-export"></i>
                                Export Data to Excel
                            </a>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- GRAPH AREA -->
            <div class="bg-white p-6 flex-1 flex">
                <div id="plot-container" class="w-full h-full relative">
                    {% if plot_html %}
                        {{ plot_html|safe }}
                    {% else %}
                        <div class="absolute inset-0 flex items-center justify-center">
                            <p class="text-gray-400">Graph will appear hereâ€¦</p>
                        </div>
                    {% endif %}
                </div>
            </div>

        </div>

    </div>
{% endblock %}